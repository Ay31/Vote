<!-- components/voteItem/voteItem.wxml -->
<view class="vote-item padding-xs radius shadow-warp bg-white margin-top">
    <view class="vote-item-hd bottom-line">
        <image wx:if="{{pageType ==='HOT'}}" src="{{voteItem.userInfo.avatarUrl}}" lazy-load="true" mode="aspectFill"></image>
        <view class="vote-item-hd-info">
            <view class="nickname" wx:if="{{pageType ==='HOT'}}">
                {{voteItem.userInfo.nickName}}
            </view>
            <view>{{voteItem.voteData.createTime}}</view>
        </view>
        <!-- <view class="vote-item-hd-op {{delOpState?'vote-item-hd-op-hover':''}}" wx:if="{{true}}" data-index="{{voteIndex}}" data-voteid="{{voteItem.voteData.id}}" bindtap="voteOP"> -->
        <view class="vote-item-hd-op vote-item-hd-op-hover" wx:if="{{true}}">
            <view class="cu-tag bg-{{voteItem.voteData.isPrivate ? 'red' : 'green'}}">
                {{voteItem.voteData.isPrivate ? '私密' : '公开'}}
            </view>
            <text class="cuIcon-more lg text-gray"></text>
        </view>
    </view>
    <view class="vote-item-con">
        <view class="vote-item-con-hd bottom-line">
            <!-- 配图 begin -->
            <view class="vote-imgs {{voteItem.voteData.imageList.length>=3?'vote-imgs-more':''}}" wx:if="{{voteItem.voteData.imageList.length>0 && pageType ==='HOT'}}">
                <view wx:if="{{voteItem.voteData.imageList.length<3}}" wx:for="{{voteItem.voteData.imageList}}" wx:key="{{index}}" class="vote-img-box">
                    <image data-src="{{item}}" lazy-load="true" data-images="{{voteItem.voteData.imageList}}" src="{{item}}" mode="aspectFill" bindtap="bindPreviewImage"></image>
                </view>
                <view wx:if="{{voteItem.voteData.imageList.length>=3}}">
                    <swiper indicator-dots="true" indicator-color="#58c9b9" indicator-active-color="#d1b6e1">
                        <block wx:for="{{voteItem.voteData.imageList}}" wx:key="{{index}}">
                            <swiper-item>
                                <image src="{{item}}" lazy-load="true" data-src="{{item}}" data-images="{{voteItem.voteData.imageList}}" class="slide-image" width="100%" height="auto" mode="aspectFill" bindtap="bindPreviewImage"></image>
                            </swiper-item>
                        </block>
                    </swiper>
                </view>
            </view>
            <!-- 配图 end -->
            <view class="vote-title">{{voteItem.voteData.voteTitle}}</view>
            <view class="vote-des-content" wx:if="{{voteItem.voteData.desTextareaData&& pageType ==='HOT'}}">
                {{voteItem.voteData.desTextareaData}}
            </view>
        </view>
        <view wx:if="{{pageType ==='HOT'}}">
            <view wx:if="{{voteItem.voteData.beforeVote}}">
                <!-- 当前用户已投票 begin -->
                <view wx:for="{{voteItem.voteData.voteOptionList}}" wx:key="{{item.id}}">
                    <view class="vote-item-data vote-item-data-voted" data-src="{{item.id}}">
                        {{item.content}}
                        <text class="vote-item-data-percent">
                            <!-- {{filter.numberToFix(item.vote_count/voteItem.voteData.voters_count*100)}}% -->
                            {{(item.count/voteItem.voteData.votersCount*100)}}%
                        </text>
                        <view class="progress-state" style="width:{{filter.numberToFix(item.vote_count/voteItem.voteData.voters_count*100)}}%;background-color:{{votedColor[index]}};"></view>
                    </view>
                </view>
                <!-- 当前用户已投票 end -->
            </view>
            <view wx:else>
                <!-- 当前用户未投票 begin -->
                <view wx:for="{{voteItem.voteData.voteOptionList}}" wx:key="{{item.id}}">
                    <!-- <view wx:if="{{index === voteItem.voteData.voteOptionList.length-1}}" bindtap="onVote" data-index="{{index}}" data-vindex="{{voteIndex}}" data-src="{{item.id}}" class="vote-item-data" hover-class="vote-item-data-active">
                    {{item.content}}
                </view> -->
                    <view class="vote-item-data bottom-line" bindtap="onVote" data-index="{{index}}" data-vindex="{{voteIndex}}" data-src="{{item.id}}" hover-class="vote-item-data-active">
                        {{item.content}}
                    </view>
                </view>
                <!-- 当前用户未投票 end -->
            </view>
        </view>
    </view>
    <view class="vote-item-ft top-line">
        <i class="fa fa-align-left" bindtap="targetToVoteDetail" data-nickname="{{vote.data.user.nick_name}}" data-index="{{voteIndex}}" data-src="{{vote.data.id}}">
            <text>{{vote.data.voters_count}}</text>
        </i>
        <button open-type="share" plain="true" data-voteid="{{vote.data.id}}" data-cover="{{filter.delWithPath(vote.data.images[0].path)}}" data-title="{{vote.data.title}}" data-nickname="{{vote.data.user.nick_name}}" bindtap="onShareAppMessage">
            <i class="fa fa-share-square-o"></i>
        </button>
    </view>
</view>