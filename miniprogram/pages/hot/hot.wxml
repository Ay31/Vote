<view class="padding-lg">
  <text class="text-white text-sl">热门投票</text>
</view>
<view wx:for="{{voteData}}">
  <view class="vote-item padding-xs radius shadow-warp bg-white margin-top" wx:if="{{nowTime < item.voteData.endingTime}}">
    <view class="vote-item-hd bottom-line">
      <image src="{{item.userInfo.avatarUrl}}" lazy-load="true" mode="aspectFill"></image>
      <view class="vote-item-hd-info">
        <view class="nickname">{{item.userInfo.nickName}}</view>
        <view>{{item.voteData.createTime}}</view>
      </view>
      <!-- <view class="vote-item-hd-op {{delOpState?'vote-item-hd-op-hover':''}}" wx:if="{{true}}" data-index="{{voteIndex}}" data-voteid="{{item.voteData.id}}" bindtap="voteOP"> -->
    </view>
    <view class="vote-item-con">
      <view class="vote-item-con-hd bottom-line">
        <!-- 配图 begin -->
        <view class="vote-imgs {{item.voteData.imageList.length>=3?'vote-imgs-more':''}}" wx:if="{{item.voteData.imageList.length>0}}">
          <view wx:if="{{item.voteData.imageList.length<3}}" wx:for="{{item.voteData.imageList}}" wx:key="{{index}}" class="vote-img-box">
            <image data-src="{{item}}" lazy-load="true" data-images="{{item.voteData.imageList}}" src="{{item}}" mode="aspectFill" bindtap="bindPreviewImage"></image>
          </view>
          <view wx:if="{{item.voteData.imageList.length>=3}}">
            <swiper indicator-dots="true" indicator-color="#58c9b9" indicator-active-color="#d1b6e1">
              <block wx:for="{{item.voteData.imageList}}" wx:key="{{index}}">
                <swiper-item>
                  <image src="{{item}}" lazy-load="true" data-src="{{item}}" data-images="{{item.voteData.imageList}}" class="slide-image" width="100%" height="auto" mode="aspectFill" bindtap="bindPreviewImage"></image>
                </swiper-item>
              </block>
            </swiper>
          </view>
        </view>
        <!-- 配图 end -->
        <view class="vote-title">{{item.voteData.voteTitle}}</view>
        <view class="vote-des-content" wx:if="{{item.voteData.desTextareaData}}">
          {{item.voteData.desTextareaData}}
        </view>
      </view>
      <view wx:if="{{item.voteData.beforeVote}}">
        <!-- 当前用户已投票 begin -->
        <view wx:for="{{item.voteData.voteOptionList}}" wx:key="{{item.id}}">
          <view class="vote-item-data vote-item-data-voted" data-src="{{item.id}}">
            {{item.content}}
            <text class="vote-item-data-percent">
              <!-- {{filter.numberToFix(item.vote_count/item.voteData.voters_count*100)}}% -->
              {{(item.count/item.voteData.votersCount*100)}}%
            </text>
            <view class="progress-state" style="width:{{filter.numberToFix(item.vote_count/item.voteData.voters_count*100)}}%;background-color:{{votedColor[index]}};"></view>
          </view>
        </view>
        <!-- 当前用户已投票 end -->
      </view>
      <view wx:else>
        <!-- 当前用户未投票 begin -->
        <view wx:for="{{item.voteData.voteOptionList}}" wx:key="{{item.id}}">
          <!-- <view wx:if="{{index === item.voteData.voteOptionList.length-1}}" bindtap="onVote" data-index="{{index}}" data-vindex="{{voteIndex}}" data-src="{{item.id}}" class="vote-item-data" hover-class="vote-item-data-active">
                    {{item.content}}
                </view> -->
          <view class="vote-item-data bottom-line" bindtap="onVote" data-index="{{index}}" data-vindex="{{voteIndex}}" data-src="{{item.id}}" hover-class="vote-item-data-active">
            {{item.content}}
          </view>
        </view>
        <!-- 当前用户未投票 end -->
      </view>
    </view>
    <view class="vote-item-ft top-line">
      <i class="fa fa-align-left" bindtap="targetToVoteDetail" data-nickname="{{vote.data.user.nick_name}}" data-index="{{voteIndex}}" data-src="{{vote.data.id}}">
        <text>{{vote.data.voters_count}}</text>
      </i>
      <button open-type="share" plain="true" data-voteid="{{vote.data.id}}" data-cover="{{filter.delWithPath(vote.data.images[0].path)}}" data-title="{{vote.data.title}}" data-nickname="{{vote.data.user.nick_name}}" bindtap="onShareAppMessage">
        <i class="fa fa-share-square-o"></i>
      </button>
    </view>
  </view>
</view>